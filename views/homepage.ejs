<%- include("partials/header.ejs") %>
<form enctype="text" onsubmit="sendPostRequest(this, undefined, undefined, undefined, undefined)">
  <div>
    <label for="title">Title:</label>
      <input type="text" id="title" name="title">
  </div>
  <div>
    <label for="img">Image URL:</label>
    <input type="text" id="img" name="img">
  </div>
  <button type="submit">Post</button>
</form>
<% posts.forEach((post) => { %>
  <% if(!post.replyTo) { %>
    <div>
      <a href="/?id=<%= post.repost ? post.ogId : post.id %>">
        <% if(post.repost) { %>
        <h4><%= post.user.name %> was reposted</h4>
        <img class="pfp" src="<%= post.repost.pp %>" />
        <h3><%= post.repost.name %></h3>
        <% } else { %>
        <img class="pfp" src="<%= post.user.pp %>" />
        <h3>
          <%= post.user.name %> <%= post.reQuote ? `is Requote to
          ${post.reQuote.user.name}`: "" %>
        </h3>
        <% } %>
        <h3><%= post.time %></h3>
        <h2><%= post.title %></h2>
        <% if(post.img) %> <img src="<%= post.img %>" />
      </a>
      <% if(post.reQuote) { %>
      <div style="border: 1px solid black; width: fit-content; padding: 10px; min-width: 300px;">
        <a href="/?id=<%= post.reQuote.id %>">
          <img class="pfp" src="<%= post.reQuote.user.pp %>" />
          <h4><%= post.reQuote.user.name %></h4>
          <h4><%= post.reQuote.time %></h4>
          <h3><%= post.reQuote.title %></h3>
          <% if(post.reQuote.img) %> <img src="<%= post.reQuote.img %>" />
        </a>
      </div>
      <% } %>
      <button onclick="sendLikeRequest('<%= JSON.stringify(post) %>')">Like: <%= post.like.total %></button>
      <button onclick="sendPostRequest(undefined, undefined, undefined, '<%= post.id %>', '<%= JSON.stringify(post) %>')">Repost</button>
    </div>
<% } }); %> 
<%- include("partials/footer.ejs") %>
